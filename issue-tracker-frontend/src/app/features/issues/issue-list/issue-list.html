<div class="issues-container">
  <h2>Issues</h2>

  <div class="filters">
    <input
      type="text"
      [(ngModel)]="filters.search"
      placeholder="Search..."
      (input)="loadIssues(1)"
    />
    <select [(ngModel)]="filters.status" (change)="loadIssues(1)">
      <option value="">All Statuses</option>
      <option value="OPEN">Open</option>
      <option value="IN_PROGRESS">In Progress</option>
      <option value="DONE">Done</option>
    </select>
    <select [(ngModel)]="filters.priority" (change)="loadIssues(1)">
      <option value="">All Priorities</option>
      <option value="LOW">Low</option>
      <option value="MEDIUM">Medium</option>
      <option value="HIGH">High</option>
    </select>
    <input type="text" [(ngModel)]="filters.tag" placeholder="Tag..." (input)="loadIssues(1)" />
    <input
      type="text"
      [(ngModel)]="filters.assigneeId"
      placeholder="Assignee ID..."
      (input)="loadIssues(1)"
    />
  </div>

  @if (issues().length > 0) {
    <table>
      <thead>
        <tr>
          <th>Title</th>
          <th>Status</th>
          <th>Priority</th>
          <th>Assignee</th>
          <th>Tags</th>
        </tr>
      </thead>
      <tbody>
        @for (issue of issues(); track issue.id) {
          <tr>
            <td>
              <a [routerLink]="['/issues', issue.id]">{{ issue.title }}</a>
            </td>
            <td>{{ issue.status }}</td>
            <td>{{ issue.priority }}</td>
            <td>
              @for (assigneeId of issue.assigneeIds; track assigneeId) {
                <span class="inline-block bg-gray-100 rounded-full px-2 py-1 text-xs font-semibold text-gray-700 mr-1">{{ assigneeId }}</span>
              }
            </td>
            <td>{{ issue.tags.join(', ') || '' }}</td>
          </tr>
        }
      </tbody>
    </table>
    <div class="pagination">
      <button [disabled]="page() === 1" (click)="loadIssues(page() - 1)">Previous</button>
      <span>Page {{ page() }}</span>
      <button [disabled]="issues().length < pageSize()" (click)="loadIssues(page() + 1)">Next</button>
    </div>
  } @else {
    <p>No issues found.</p>
  }
</div>
